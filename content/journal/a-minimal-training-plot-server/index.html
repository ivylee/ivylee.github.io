<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-162951235-1"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-162951235-1");
    </script>

    <title>a minimal training plot server - Ivy Lee</title><meta name="gridsome:hash" content="1ff7fd21744cc2fcc762d34d304f9b98b3f37530"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="Writings by Ivy Lee, Creative Technologist experienced in Data Science, Machine Learning, Deep Learning"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.e0811aa2d901a2d517912241f856735c.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.e0811aa2d901a2d517912241f856735c.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.e0811aa2d901a2d517912241f856735c.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/touchicon.f22e9f3.8adfe1442cdabafcdfc4196418110b5a.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/touchicon.62d22cb.8adfe1442cdabafcdfc4196418110b5a.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/touchicon.1539b60.8adfe1442cdabafcdfc4196418110b5a.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/touchicon.dc0cdc5.8adfe1442cdabafcdfc4196418110b5a.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/touchicon.7b22250.8adfe1442cdabafcdfc4196418110b5a.png"><link rel="preload" href="/assets/css/0.styles.9d9a94ab.css" as="style"><link rel="preload" href="/assets/js/app.7ffd0163.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--journal-post-vue.ee3f7f82.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.286d17b8.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.191d8bdb.js"><link rel="prefetch" href="/assets/js/page--src--pages--journal-vue.0f400f41.js"><link rel="prefetch" href="/assets/js/page--src--templates--project-post-vue.b958d339.js"><link rel="stylesheet" href="/assets/css/0.styles.9d9a94ab.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout" data-v-354b4fc1><header class="header" data-v-e5cfe63c><div class="container" data-v-e5cfe63c><div class="left" data-v-e5cfe63c><a href="/" class="home-link active" data-v-e5cfe63c><h1 data-v-e5cfe63c>Ivy Lee</h1></a></div><nav class="nav right" data-v-e5cfe63c><a href="/journal" class="nav__link" data-v-e5cfe63c>Posts</a><a href="/resume.pdf" class="nav__link" data-v-e5cfe63c>Resume</a></nav></div></header><div class="journal" data-v-354b4fc1><div class="container journal-container" data-v-354b4fc1><div class="journal-header" data-v-354b4fc1><h1 class="journal-title" data-v-354b4fc1>a minimal training plot server</h1><div class="journal-meta" data-v-354b4fc1><div class="journal-date" data-v-354b4fc1><div data-v-354b4fc1>March 4 2017</div></div></div></div><div class="journal-content" data-v-354b4fc1><p>Training a deep convolutional neural network (CNN) can be a lengthy process.
We usually want to monitor training loss and accuracy and validation loss and accuracy by plotting how these metrics
change as the number of minibatches grows on a graph.
<a href="https://www.tensorflow.org" target="_blank" rel="nofollow noopener noreferrer">Tensorflow</a> provides <a href="https://www.tensorflow.org/get_started/summaries_and_tensorboard" target="_blank" rel="nofollow noopener noreferrer">Tensorboard</a> for visualizing training progress.
Recently I have been playing with <a href="http://pytorch.org" target="_blank" rel="nofollow noopener noreferrer">PyTorch</a>, I really like its expresiveness and flexibility.
Here's a strategy for visualizing training progress with
any learning framework that doesn't provide Tensorboard-equivalent feature out of the box using Python 3.</p>
<p>First of all as a good practice we output relevant metrics into a log file, the log file should be structured in a way
that is easy to parse and extract metrics. We will need to write a parser method, and a plot method to generate desired
graph(s). <a href="http://matplotlib.org" target="_blank" rel="nofollow noopener noreferrer">matplotlib</a>, <a href="http://seaborn.pydata.org" target="_blank" rel="nofollow noopener noreferrer">seaborn</a>, <a href="http://ggplot.yhathq.com" target="_blank" rel="nofollow noopener noreferrer">ggplot</a> or <a href="http://bokeh.pydata.org/en/latest" target="_blank" rel="nofollow noopener noreferrer">bokeh</a> are useful python libraries for graphing.</p>
<p>Then we can use <a href="https://docs.python.org/3/library/asyncio.html" target="_blank" rel="nofollow noopener noreferrer">asyncio</a> to create a background job to plot the metrics we want to visualize and use <a href="http://aiohttp.readthedocs.io/en/stable" target="_blank" rel="nofollow noopener noreferrer">aiohttp</a> to create
a web server that displays and refreshes the graph(s) at a certain interval.</p>
<pre class="language-python"><code class="language-python"><span class="token comment"># Using python 3.4</span>
<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> argparse
<span class="token keyword">from</span> aiohttp <span class="token keyword">import</span> web


GRAPH_LOCATION <span class="token operator">=</span> <span class="token string">"static/train_plot.png"</span>


<span class="token keyword">def</span> <span class="token function">parser</span><span class="token punctuation">(</span>log_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># read log_file and extract metrics such as</span>
    <span class="token comment"># minibatch number, training loss, training accuracy,</span>
    <span class="token comment"># validation loss, validation accuracy</span>
    <span class="token keyword">return</span> metrics


<span class="token keyword">def</span> <span class="token function">plot</span><span class="token punctuation">(</span>metrics<span class="token punctuation">,</span> output<span class="token operator">=</span>GRAPH_LOCATION<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># save output image to GRAPH_LOCATION</span>


<span class="token keyword">def</span> <span class="token function">plot_loop</span><span class="token punctuation">(</span>args<span class="token punctuation">,</span> loop<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Updating plot"</span><span class="token punctuation">)</span>
    metrics <span class="token operator">=</span> parser<span class="token punctuation">(</span>args<span class="token punctuation">.</span>log_file<span class="token punctuation">)</span>
    plot<span class="token punctuation">(</span>metrics<span class="token punctuation">)</span>
    loop<span class="token punctuation">.</span>call_later<span class="token punctuation">(</span>args<span class="token punctuation">.</span>interval<span class="token punctuation">,</span> plot_loop<span class="token punctuation">,</span> args<span class="token punctuation">,</span> loop<span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@asyncio<span class="token punctuation">.</span>coroutine</span>
<span class="token keyword">def</span> <span class="token function">handler</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    interval <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'interval'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    resp <span class="token operator">=</span> web<span class="token punctuation">.</span>StreamResponse<span class="token punctuation">(</span>status<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>
                                reason<span class="token operator">=</span><span class="token string">'OK'</span><span class="token punctuation">,</span>
                                headers<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'text/html'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">yield</span> <span class="token keyword">from</span> resp<span class="token punctuation">.</span>prepare<span class="token punctuation">(</span>request<span class="token punctuation">)</span>

    html_str <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
        &lt;html>
            &lt;head>
                &lt;meta http-equiv='refresh' content='{}'>
            &lt;/head>
            &lt;body>
                &lt;img src='{}' width='100%'/>
            &lt;/body>
        &lt;/html>
    """</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>interval<span class="token punctuation">,</span> GRAPH_LOCATION<span class="token punctuation">)</span>
    resp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span>html_str<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">yield</span> <span class="token keyword">from</span> resp<span class="token punctuation">.</span>drain<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> resp


<span class="token decorator annotation punctuation">@asyncio<span class="token punctuation">.</span>coroutine</span>
<span class="token keyword">def</span> <span class="token function">build_server</span><span class="token punctuation">(</span>loop<span class="token punctuation">,</span> address<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">:</span>
    app <span class="token operator">=</span> web<span class="token punctuation">.</span>Application<span class="token punctuation">(</span>loop<span class="token operator">=</span>loop<span class="token punctuation">)</span>
    app<span class="token punctuation">.</span>router<span class="token punctuation">.</span>add_route<span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">"/plot"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
    app<span class="token punctuation">.</span>router<span class="token punctuation">.</span>add_static<span class="token punctuation">(</span><span class="token string">'/static'</span><span class="token punctuation">,</span> <span class="token string">"static"</span><span class="token punctuation">)</span>
    ret <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token keyword">from</span> loop<span class="token punctuation">.</span>create_server<span class="token punctuation">(</span>app<span class="token punctuation">.</span>make_handler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> address<span class="token punctuation">,</span> port<span class="token punctuation">)</span>
    <span class="token keyword">return</span> ret


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">'Training graphs server'</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'log_file'</span><span class="token punctuation">,</span>
                        <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'path to train log file'</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--interval'</span><span class="token punctuation">,</span> <span class="token string">'-i'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>
                        <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'plot interval'</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--port'</span><span class="token punctuation">,</span> <span class="token string">'-p'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">7777</span><span class="token punctuation">,</span>
                        <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'server port'</span><span class="token punctuation">)</span>
    args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>

    loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>
    loop<span class="token punctuation">.</span>call_soon<span class="token punctuation">(</span>plot_loop<span class="token punctuation">,</span> args<span class="token punctuation">,</span> loop<span class="token punctuation">)</span>
    loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span>build_server<span class="token punctuation">(</span>loop<span class="token punctuation">,</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> args<span class="token punctuation">.</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        loop<span class="token punctuation">.</span>run_forever<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Server shutting down!"</span><span class="token punctuation">)</span>
        loop<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>This snippet can also be found <a href="https://gist.github.com/ivylee/f1b00ce54f948e627605598ccf3cf4b9" target="_blank" rel="nofollow noopener noreferrer">here</a>.</p>
</div></div></div><footer class="footer" data-v-3a0848c0><div class="container" data-v-3a0848c0><span data-v-3a0848c0>Copyright © 2021</span></div></footer></div> <script>window.__INITIAL_STATE__={"data":{"post":{"title":"a minimal training plot server","date":"March 4 2017","content":"\u003Cp\u003ETraining a deep convolutional neural network (CNN) can be a lengthy process.\nWe usually want to monitor training loss and accuracy and validation loss and accuracy by plotting how these metrics\nchange as the number of minibatches grows on a graph.\n\u003Ca href=\"https:\u002F\u002Fwww.tensorflow.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ETensorflow\u003C\u002Fa\u003E provides \u003Ca href=\"https:\u002F\u002Fwww.tensorflow.org\u002Fget_started\u002Fsummaries_and_tensorboard\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ETensorboard\u003C\u002Fa\u003E for visualizing training progress.\nRecently I have been playing with \u003Ca href=\"http:\u002F\u002Fpytorch.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EPyTorch\u003C\u002Fa\u003E, I really like its expresiveness and flexibility.\nHere's a strategy for visualizing training progress with\nany learning framework that doesn't provide Tensorboard-equivalent feature out of the box using Python 3.\u003C\u002Fp\u003E\n\u003Cp\u003EFirst of all as a good practice we output relevant metrics into a log file, the log file should be structured in a way\nthat is easy to parse and extract metrics. We will need to write a parser method, and a plot method to generate desired\ngraph(s). \u003Ca href=\"http:\u002F\u002Fmatplotlib.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ematplotlib\u003C\u002Fa\u003E, \u003Ca href=\"http:\u002F\u002Fseaborn.pydata.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eseaborn\u003C\u002Fa\u003E, \u003Ca href=\"http:\u002F\u002Fggplot.yhathq.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eggplot\u003C\u002Fa\u003E or \u003Ca href=\"http:\u002F\u002Fbokeh.pydata.org\u002Fen\u002Flatest\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ebokeh\u003C\u002Fa\u003E are useful python libraries for graphing.\u003C\u002Fp\u003E\n\u003Cp\u003EThen we can use \u003Ca href=\"https:\u002F\u002Fdocs.python.org\u002F3\u002Flibrary\u002Fasyncio.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Easyncio\u003C\u002Fa\u003E to create a background job to plot the metrics we want to visualize and use \u003Ca href=\"http:\u002F\u002Faiohttp.readthedocs.io\u002Fen\u002Fstable\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eaiohttp\u003C\u002Fa\u003E to create\na web server that displays and refreshes the graph(s) at a certain interval.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-python\"\u003E\u003Ccode class=\"language-python\"\u003E\u003Cspan class=\"token comment\"\u003E# Using python 3.4\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E asyncio\n\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E argparse\n\u003Cspan class=\"token keyword\"\u003Efrom\u003C\u002Fspan\u003E aiohttp \u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E web\n\n\nGRAPH_LOCATION \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"static\u002Ftrain_plot.png\"\u003C\u002Fspan\u003E\n\n\n\u003Cspan class=\"token keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Eparser\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Elog_file\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token comment\"\u003E# read log_file and extract metrics such as\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token comment\"\u003E# minibatch number, training loss, training accuracy,\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token comment\"\u003E# validation loss, validation accuracy\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E metrics\n\n\n\u003Cspan class=\"token keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Eplot\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Emetrics\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E output\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003EGRAPH_LOCATION\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token comment\"\u003E# save output image to GRAPH_LOCATION\u003C\u002Fspan\u003E\n\n\n\u003Cspan class=\"token keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Eplot_loop\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eargs\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E loop\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Eprint\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"Updating plot\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    metrics \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E parser\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eargs\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Elog_file\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    plot\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Emetrics\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    loop\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ecall_later\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eargs\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Einterval\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E plot_loop\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E args\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E loop\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\n\u003Cspan class=\"token decorator annotation punctuation\"\u003E@asyncio\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ecoroutine\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Ehandler\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Erequest\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    interval \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Eint\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Erequest\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EGET\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eget\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'interval'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E30\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    resp \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E web\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EStreamResponse\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Estatus\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E200\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n                                reason\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'OK'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n                                headers\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'Content-Type'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'text\u002Fhtml'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"token keyword\"\u003Eyield\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efrom\u003C\u002Fspan\u003E resp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eprepare\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Erequest\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n    html_str \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token triple-quoted-string string\"\u003E\"\"\"\n        &lt;html\u003E\n            &lt;head\u003E\n                &lt;meta http-equiv='refresh' content='{}'\u003E\n            &lt;\u002Fhead\u003E\n            &lt;body\u003E\n                &lt;img src='{}' width='100%'\u002F\u003E\n            &lt;\u002Fbody\u003E\n        &lt;\u002Fhtml\u003E\n    \"\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Eformat\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Einterval\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E GRAPH_LOCATION\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    resp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ewrite\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Estr\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eencode\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ehtml_str\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"token keyword\"\u003Eyield\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efrom\u003C\u002Fspan\u003E resp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Edrain\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E resp\n\n\n\u003Cspan class=\"token decorator annotation punctuation\"\u003E@asyncio\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ecoroutine\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Ebuild_server\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eloop\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E address\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E port\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    app \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E web\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EApplication\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eloop\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003Eloop\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    app\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Erouter\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eadd_route\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'GET'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"\u002Fplot\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E handler\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    app\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Erouter\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eadd_static\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'\u002Fstatic'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"static\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    ret \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eyield\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efrom\u003C\u002Fspan\u003E loop\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ecreate_server\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eapp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Emake_handler\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E address\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E port\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E ret\n\n\n\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E __name__ \u003Cspan class=\"token operator\"\u003E==\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"__main__\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    parser \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E argparse\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EArgumentParser\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edescription\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'Training graphs server'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    parser\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eadd_argument\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'log_file'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n                        \u003Cspan class=\"token builtin\"\u003Ehelp\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'path to train log file'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    parser\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eadd_argument\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'--interval'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'-i'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E default\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E30\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n                        \u003Cspan class=\"token builtin\"\u003Ehelp\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'plot interval'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    parser\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eadd_argument\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'--port'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'-p'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E default\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E7777\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n                        \u003Cspan class=\"token builtin\"\u003Ehelp\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'server port'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    args \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E parser\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eparse_args\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n    loop \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E asyncio\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eget_event_loop\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    loop\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Ecall_soon\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eplot_loop\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E args\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E loop\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    loop\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Erun_until_complete\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ebuild_server\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eloop\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'0.0.0.0'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E args\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eport\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Etry\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n        loop\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Erun_forever\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Eexcept\u003C\u002Fspan\u003E KeyboardInterrupt\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Eprint\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"Server shutting down!\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n        loop\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eclose\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThis snippet can also be found \u003Ca href=\"https:\u002F\u002Fgist.github.com\u002Fivylee\u002Ff1b00ce54f948e627605598ccf3cf4b9\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehere\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.7ffd0163.js" defer></script><script src="/assets/js/page--src--templates--journal-post-vue.ee3f7f82.js" defer></script>
  </body>
</html>
